import{r as o,c as v,d as k,j as e,G as d,R as f,U as P,g as m,T as y,z as O,H as M,J as G,K as w,N as l,Q as Y,F as se,V as re,E as le}from"./index-CxJtQRLb.js";import{S as ae}from"./Search-BCnfRBZA.js";import{h as A}from"./moment-G82_0lEo.js";import{D as ne}from"./DateFilter-3Dz2lqSw.js";import{D as W,a as q,b as N}from"./DialogContent-DOuEahYY.js";import{f as F}from"./format-cwXK75ha.js";const ie=({onClose:x})=>{const[c,S]=o.useState([]),[h,n]=o.useState({pro_id:"",sale_address:"",quantity:"",price:"",gst:"",total:""}),[p,u]=o.useState({pro_id:"",sale_address:"",quantity:"",price:"",gst:"",total:""});o.useEffect(()=>{v.get(`${k.apiUrl}/product/getProductData`).then(s=>{S(s.data)}).catch(s=>{console.log("Product Data is not fetched.",s)})},[]);const C=(s,r)=>{let t="";const i=r&&typeof r=="string"?r.trim():r;switch(s){case"pro_id":i||(t="Product Name is Required");break;case"sale_address":i||(t="Address is Required");break;case"quantity":i||(t="Quantity is Required");break;case"price":i||(t="Price is Required");break;case"total":i||(t="Total is Required");break;case"gst":i||(t="GST is Required");break}return t},g=s=>{const{name:r,value:t}=s.target,i=C(r,t);n({...h,[r]:t}),u({...p,[r]:i})};o.useEffect(()=>{const{quantity:s,price:r,gst:t}=h;if(s&&r&&t){const i=(Number(s)*Number(r)*(1+Number(t)/100)).toFixed(2);n(b=>({...b,total:i})),u(b=>({...b,total:""}))}},[h.quantity,h.price,h.gst]);const j=s=>{s.preventDefault();let r={};if(Object.keys(h).forEach(t=>{const i=h[t],b=C(t,i);b&&(r[t]=b)}),Object.keys(r).length>0){u(r);return}v.post(`${k.apiUrl}/sales/saveSales`,h).then(t=>{x()}).catch(t=>{console.log("Sales Data is not added.",t)})},_=()=>{n({pro_id:"",sale_address:"",quantity:"",price:"",gst:"",total:""}),u({pro_id:"",sale_address:"",quantity:"",price:"",gst:"",total:""})};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center",children:"Add Sales"}),e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,select:!0,name:"pro_id",label:"Product Name",value:h.pro_id,onChange:g,error:!!p.pro_id,helperText:p.pro_id,children:c.map(s=>e.jsx(P,{value:s.pro_id,children:s.pro_name},s.pro_id))})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"sale_address",label:"Address",value:h.sale_address,onChange:g,error:!!p.sale_address,helperText:p.sale_address})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"quantity",label:"Quantity",type:"number",value:h.quantity,onChange:g,error:!!p.quantity,helperText:p.quantity})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"price",label:"Price",type:"number",value:h.price,onChange:g,error:!!p.price,helperText:p.price})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"gst",label:"GST",type:"number",value:h.gst,onChange:g,error:!!p.gst,helperText:p.gst})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"total",label:"Total",type:"number",value:h.total,onChange:g,error:!!p.total,helperText:p.total,disabled:!0})}),e.jsxs(d,{item:!0,xs:12,display:"flex",justifyContent:"center",children:[e.jsx(m,{onClick:j,children:"Submit"}),e.jsx(m,{onClick:_,style:{marginLeft:"20px"},children:"Clear"})]})]})]})},de=({onClose:x,data:c})=>{const[S,h]=o.useState([]),[n,p]=o.useState({pro_id:c?c.pro_id:"",sale_address:c?c.sale_address:"",quantity:c?c.quantity:"",price:c?c.price:"",gst:c?c.gst:"",total:c?c.total:""}),[u,C]=o.useState({pro_id:"",sale_address:"",quantity:"",price:"",gst:"",total:""});o.useEffect(()=>{v.get(`${k.apiUrl}/product/getProductData`).then(s=>{h(s.data)}).catch(s=>{console.log("Product Data is not fetched.",s)})},[]);const g=(s,r)=>{let t="";const i=r&&typeof r=="string"?r.trim():r;switch(s){case"pro_id":i||(t="Product Name is Required");break;case"sale_address":i||(t="Address is Required");break;case"quantity":i||(t="Quantity is Required");break;case"price":i||(t="Price is Required");break;case"total":i||(t="Total is Required");break;case"gst":i||(t="GST is Required");break}return t},j=s=>{const{name:r,value:t}=s.target,i=g(r,t);p({...n,[r]:t}),C({...u,[r]:i})},_=s=>{s.preventDefault();let r={};if(Object.keys(n).forEach(t=>{const i=n[t],b=g(t,i);b&&(r[t]=b)}),Object.keys(r).length>0){C(r);return}v.put(`${k.apiUrl}/sales/update/${c.sale_id}`,n).then(t=>{x()}).catch(t=>{console.log("Sales Data is not added.",t)})};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center",children:"Add Purchase"}),e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,select:!0,name:"pro_id",label:"Product Name",value:n.pro_id,onChange:j,error:!!u.pro_id,helperText:u.pro_id,children:S.map(s=>e.jsx(P,{value:s.pro_id,children:s.pro_name},s.pro_id))})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"sale_address",label:"Address",value:n.sale_address,onChange:j,error:!!u.sale_address,helperText:u.sale_address})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"quantity",label:"Quantity",type:"number",value:n.quantity,onChange:j,error:!!u.quantity,helperText:u.quantity})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"price",label:"Price",type:"number",value:n.price,onChange:j,error:!!u.price,helperText:u.price})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"gst",label:"GST",type:"number",value:n.gst,onChange:j,error:!!u.gst,helperText:u.gst})}),e.jsx(d,{item:!0,xs:6,children:e.jsx(f,{fullWidth:!0,name:"total",label:"Total",type:"number",value:n.total,onChange:j,error:!!u.total,helperText:u.total})}),e.jsx(d,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(m,{onClick:_,children:"Update"})})]})]})},oe=""+new URL("logo (1)-DahH5gU4.png",import.meta.url).href,ce=({data:x,dueDate:c})=>e.jsxs("div",{style:{fontFamily:"Arial, sans-serif",fontSize:"12px"},children:[e.jsx(y,{variant:"h4",align:"center",style:{marginBottom:"20px"},children:"Invoice"}),e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:12,display:"flex",justifyContent:"end",children:e.jsx("img",{src:oe,alt:"Company Logo",width:"100",height:"100"})}),e.jsxs(d,{item:!0,xs:4,children:[e.jsx(y,{variant:"h6",style:{fontWeight:"bold"},children:"From"}),e.jsx(y,{children:x.purch_address})]}),e.jsxs(d,{item:!0,xs:4,children:[e.jsx(y,{variant:"h6",style:{fontWeight:"bold"},children:"To"}),e.jsx(y,{children:"Krishna Industries"}),e.jsx(y,{children:"Peelamedu, Singanallur"}),e.jsx(y,{children:"Coimbatore, 627757"})]}),e.jsxs(d,{item:!0,xs:4,children:[e.jsxs(y,{variant:"h6",style:{display:"inline-block",marginRight:"20px"},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"Invoice Date    : "})," ",A().format("YYYY-MM-DD")]}),e.jsxs(y,{variant:"h6",style:{display:"inline-block",marginTop:"2px"},children:[e.jsx("span",{style:{fontWeight:"bold"},children:"Due Date           :"})," ",A(c).format("YYYY-MM-DD")]})]})]}),e.jsx(O,{style:{marginTop:"20px"},children:e.jsxs(M,{children:[e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(l,{style:{border:"1px solid #ddd",fontWeight:"bold"},children:"S.No"}),e.jsx(l,{style:{border:"1px solid #ddd",fontWeight:"bold"},children:"Product Name"}),e.jsx(l,{style:{border:"1px solid #ddd",fontWeight:"bold"},children:"Description"}),e.jsx(l,{style:{border:"1px solid #ddd",fontWeight:"bold"},children:"Quantity"}),e.jsx(l,{style:{border:"1px solid #ddd",fontWeight:"bold"},children:"Price"}),e.jsx(l,{style:{border:"1px solid #ddd",fontWeight:"bold"},children:"Total"})]})}),e.jsx(Y,{children:e.jsxs(w,{children:[e.jsx(l,{style:{border:"1px solid #ddd"},children:"01"}),e.jsx(l,{style:{border:"1px solid #ddd"},children:x.pro_name}),e.jsx(l,{style:{border:"1px solid #ddd"},children:x.specification}),e.jsx(l,{style:{border:"1px solid #ddd"},children:x.quantity}),e.jsx(l,{style:{border:"1px solid #ddd"},children:x.price}),e.jsx(l,{style:{border:"1px solid #ddd"},children:x.total})]})})]})}),e.jsxs("div",{style:{marginTop:"20px",borderTop:"1px solid #ddd",textAlign:"right"},children:[e.jsxs(y,{className:"mt-2",variant:"h6",children:[" ",e.jsx("span",{style:{fontWeight:"bold"},children:"Price"})," : ",x.price]}),e.jsxs(y,{className:"mt-2",variant:"h6",children:[" ",e.jsx("span",{style:{fontWeight:"bold"},children:"GST 18%"})," : ",x.gst]}),e.jsxs(y,{className:"mt-2",variant:"h6",children:[" ",e.jsx("span",{style:{fontWeight:"bold"},children:"Total"})," : ",x.total]})]})]}),he=({data:x})=>{const[c,S]=o.useState(null),h=()=>{const n=document.getElementById("printButton");n&&(n.style.display="none"),window.print(),n&&(n.style.display="block")};return e.jsx(e.Fragment,{children:c?e.jsxs(e.Fragment,{children:[e.jsx(ce,{data:x,dueDate:c}),e.jsx(m,{id:"printButton",onClick:h,style:{display:"block",margin:"20px auto"},children:"Print"})]}):e.jsx(f,{label:"Due Date",type:"date",InputLabelProps:{shrink:!0},onChange:n=>S(n.target.value),value:c})})},ye=()=>{const[x,c]=o.useState([]),[S,h]=o.useState([]),[n,p]=o.useState(5),[u,C]=o.useState(1),[g,j]=o.useState(!1),[_,s]=o.useState(!1),[r,t]=o.useState(!1),[i,b]=o.useState(),[U,$]=o.useState(),[B,E]=o.useState(!1),[Q,xe]=o.useState([]),[I,L]=o.useState(""),[R,V]=o.useState("");o.useEffect(()=>{v.get(`${k.apiUrl}/sales/getSale`).then(a=>{c(a.data),h(a.data)}).catch(a=>{console.log("Sales Data could not be fetched.",a)})},[g,_,r]);const H=a=>{const D=parseInt(a.target.value,10);D===1?(p(x.length),C(1)):(p(D),C(1))},z=(u-1)*n,K=u*n,J=S.slice(z,K),X=a=>{const D=x.find(T=>T.sale_id===a);D&&(b(D),s(!0))},Z=a=>{a&&($(a),t(!0))},ee=()=>{U&&v.delete(`${k.apiUrl}/sales/delete/${U}`).then(a=>{t(!1)}).catch(a=>{console.log("Sales Data is not deleted.",a)})},te=()=>{if(I&&R){const a=x.filter(D=>{const T=F(new Date(D.created_at),"yyyy-MM-dd");return T>=I&&T<=R});h(a)}else h(x)};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center",children:"Sales Index"}),e.jsxs(d,{container:!0,spacing:3,className:"mt-3",children:[e.jsx(d,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(m,{onClick:()=>j(!0),children:"Add New"})}),e.jsx(d,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(ae,{data:x,setData:h})}),e.jsx(d,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(se,{children:e.jsxs(re,{value:n,onChange:H,children:[e.jsx(P,{value:5,children:"5 Per Page"}),e.jsx(P,{value:10,children:"10 Per Page"}),e.jsx(P,{value:15,children:"15 Per Page"}),e.jsx(P,{value:1,children:"All Per Page"})]})})})]}),e.jsx(ne,{startDate:I,endDate:R,setStartDate:L,setEndDate:V,onFilter:te}),e.jsx(O,{component:le,className:"mt-3",children:e.jsxs(M,{children:[e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(l,{style:{fontWeight:"bold"},children:"S.No"}),e.jsx(l,{style:{fontWeight:"bold"},children:"Product Name"}),e.jsx(l,{style:{fontWeight:"bold"},children:"Address"}),e.jsx(l,{style:{fontWeight:"bold"},children:"Quantity"}),e.jsx(l,{style:{fontWeight:"bold"},children:"Price"}),e.jsx(l,{style:{fontWeight:"bold"},children:"Date"}),e.jsx(l,{style:{fontWeight:"bold"},children:"Total"}),e.jsx(l,{style:{fontWeight:"bold"},children:"GST"}),e.jsx(l,{style:{fontWeight:"bold"},children:"Action"})]})}),e.jsx(Y,{children:J.map((a,D)=>e.jsxs(w,{children:[e.jsx(l,{children:D+1}),e.jsx(l,{children:a.pro_name}),e.jsx(l,{children:a.sale_address}),e.jsx(l,{children:a.quantity}),e.jsx(l,{children:a.price}),e.jsx(l,{children:F(new Date(a.created_at),"dd/MM/yyyy")})," ",e.jsx(l,{children:a.gst}),e.jsx(l,{children:a.total}),e.jsxs(l,{children:[e.jsx(m,{onClick:()=>X(a.sale_id),children:"Edit"}),e.jsx(m,{onClick:()=>Z(a.sale_id),children:"Delete"})]})]},D))})]})}),e.jsxs(W,{open:g,onClose:()=>j(!1),maxWidth:"md",children:[e.jsx(q,{children:e.jsx(ie,{onClose:()=>j(!1)})}),e.jsx(N,{children:e.jsx(m,{onClick:()=>j(!1),children:"Close"})})]}),e.jsxs(W,{open:_,onClose:()=>s(!1),maxWidth:"md",children:[e.jsx(q,{children:e.jsx(de,{data:i,onClose:()=>s(!1)})}),e.jsx(N,{children:e.jsx(m,{onClick:()=>s(!1),children:"Close"})})]}),e.jsxs(W,{open:B,onClose:()=>E(!1),maxWidth:"md",children:[e.jsx(q,{children:e.jsx(he,{data:Q,onClose:()=>E(!1)})}),e.jsxs(N,{className:"mt-5",children:[e.jsx(m,{onClick:()=>window.print(),style:{display:"block"},children:"Print"}),e.jsx(m,{onClick:()=>E(!1),children:"Close"})]})]}),e.jsxs(W,{open:r,onClose:()=>t(!1),children:[e.jsx(q,{children:e.jsx("p",{children:"Are you sure do you want to delete this Sales data ?"})}),e.jsxs(N,{children:[e.jsx(m,{onClick:ee,style:{backgroundColor:"red",color:"whitesmoke"},children:"Delete"}),e.jsx(m,{onClick:()=>t(!1),style:{backgroundColor:"green",color:"white"},children:"Cancel"})]})]})]})};export{ye as default};
