import{r as x,j as e,G as n,R as j,g as p,c as I,d as A,T as b,z as O,H as B,J as Y,K as R,N as s,Q,F as ce,V as de,U as q,E as he,S as xe}from"./index-CxJtQRLb.js";import{I as E}from"./InputAdornment-Df2-mKqN.js";import{S as ue}from"./Search-BCnfRBZA.js";import{l as pe}from"./Krishna Industries2-CaiO6x1k.js";import{h as U}from"./moment-G82_0lEo.js";import je from"./UploadExell-BJrYjm6o.js";import{D as me}from"./DateFilter-BhaPmPsL.js";import{P as fe}from"./Pagination-CQtFweVv.js";import{D as W,a as S,b as T}from"./DialogContent-DOuEahYY.js";import{f as G}from"./format-cwXK75ha.js";const ge=({onClose:t})=>{const[d,u]=x.useState({pro_name:"",specification:"",purch_address:"",quantity:"",price:"",total:"",gst:16,cgst:8,sgst:8}),h=o=>{const{name:a,value:D}=o.target,g={...d,[a]:D};u(g),(a==="price"||a==="quantity"||a==="gst")&&i(g)},i=o=>{const a=parseFloat(o.quantity)||0,D=parseFloat(o.price)||0,g=parseFloat(o.gst)||0,y=a*D,c=Math.round(y*g/200),l=Math.round(y*g/200),m=Math.round(y+c+l);u({...o,total:m,cgst:c,sgst:l})},C=o=>{o.preventDefault(),I.post(`${A.apiUrl}/purchase/savePurchase`,d).then(a=>{t()}).catch(a=>{console.log("Purchase Data is not added.",a)})};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-center",children:"Add Purchase"}),e.jsxs(n,{container:!0,spacing:3,className:"mt-3",children:[e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"pro_name",label:"Product Name",onChange:h,value:d.pro_name})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"specification",label:"Specification",onChange:h,value:d.specification})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"purch_address",label:"Address",onChange:h,value:d.purch_address})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"quantity",label:"Quantity",type:"number",onChange:h,value:d.quantity})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"price",label:"Price",type:"number",onChange:h,value:d.price})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"gst",label:"GST",type:"number",onChange:h,value:d.gst})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"total",label:"Total",type:"number",value:d.total,disabled:!0,InputProps:{startAdornment:e.jsx(E,{position:"start",children:"₹"})}})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"cgst",label:"CGST",type:"number",value:d.cgst,disabled:!0,InputProps:{startAdornment:e.jsx(E,{position:"start",children:"₹"})}})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"sgst",label:"SGST",type:"number",value:d.sgst,disabled:!0,InputProps:{startAdornment:e.jsx(E,{position:"start",children:"₹"})}})}),e.jsx(n,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(p,{onClick:C,children:"Submit"})})]})]})},ye=({data:t,onClose:d})=>{const[u,h]=x.useState({pro_name:t?t.pro_name:"",specification:t?t.specification:"",purch_address:t?t.purch_address:"",quantity:t?t.quantity:"",price:t?t.price:"",total:t?t.total:"",gst:t?t.gst:""}),[i,C]=x.useState({pro_name:"",specification:"",purch_address:"",quantity:"",price:"",total:"",gst:""}),o=(y,c)=>{let l="";const m=c&&typeof c=="string"?c.trim():c;switch(y){case"pro_name":m||(l="Product Name is Required");break;case"specification":m||(l="Specification is Required");break;case"purch_address":m||(l="Address is Required");break;case"quantity":m||(l="Quantity is Required");break;case"price":m||(l="Price is Required");break;case"total":m||(l="Total is Required");break;case"gst":m||(l="GST is Required");break}return l},a=y=>{const{name:c,value:l}=y.target,m=o(c,l);h({...u,[c]:l}),C({...i,[c]:m})},D=y=>{y.preventDefault();let c={};if(Object.keys(u).forEach(l=>{const m=u[l],v=o(l,m);v&&(c[l]=v)}),Object.keys(c).length>0){C(c);return}I.put(`${A.apiUrl}/purchase/update/${t.purch_id}`,u).then(l=>{d()}).catch(l=>{console.log("Purchase Data is not added.",l)})},g=()=>{h({pro_name:"",specification:"",purch_address:"",quantity:"",price:"",total:"",gst:""}),C({pro_name:"",specification:"",purch_address:"",quantity:"",price:"",total:"",gst:""})};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center",children:"Add Purchase"}),e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"pro_name",label:"Product Name",value:u.pro_name,onChange:a,error:!!i.pro_name,helperText:i.pro_name})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"specification",label:"Specification",value:u.specification,onChange:a,error:!!i.specification,helperText:i.specification})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"purch_address",label:"Address",value:u.purch_address,onChange:a,error:!!i.purch_address,helperText:i.purch_address})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"quantity",label:"Quantity",type:"number",value:u.quantity,onChange:a,error:!!i.quantity,helperText:i.quantity})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"price",label:"Price",type:"number",value:u.price,onChange:a,error:!!i.price,helperText:i.price})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"total",label:"Total",type:"number",value:u.total,onChange:a,error:!!i.total,helperText:i.total})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,name:"gst",label:"GST",type:"number",value:u.gst,onChange:a,error:!!i.gst,helperText:i.gst})}),e.jsxs(n,{item:!0,xs:12,display:"flex",justifyContent:"center",children:[e.jsx(p,{onClick:D,children:"Update"}),e.jsx(p,{onClick:g,style:{marginLeft:"20px"},children:"Clear"})]})]})]})},be=(t,d)=>t*d/100,Ce=({data:t,dueDate:d})=>{const h=parseFloat(t.price)||0,i=be(h,18),C=h+i,o=x.useRef(null),a=()=>{o.current&&(o.current.style.display="none"),window.print(),setTimeout(()=>{o.current&&(o.current.style.display="block")},100)};return e.jsxs("div",{style:{fontFamily:"Arial, sans-serif",fontSize:"12px",backgroundColor:"#e8f5e9",padding:"20px",borderRadius:"8px"},children:[e.jsx(b,{variant:"h4",align:"center",style:{marginBottom:"20px",color:"#4CAF50"},children:"Purchase Invoice"}),e.jsxs(n,{container:!0,spacing:3,alignItems:"center",children:[e.jsx(n,{item:!0,xs:12,container:!0,justifyContent:"flex-end",children:e.jsx("img",{src:pe,alt:"Company Logo",width:"100",height:"100"})}),e.jsxs(n,{item:!0,xs:4,children:[e.jsx(b,{variant:"h6",style:{fontWeight:"bold",color:"#2196F3"},children:"From"}),e.jsx(b,{children:"Krishna"}),e.jsx(b,{children:"Peelamedu, Singanallur"}),e.jsx(b,{children:"Coimbatore, 627757"})]}),e.jsxs(n,{item:!0,xs:4,children:[e.jsx(b,{variant:"h6",style:{fontWeight:"bold",color:"#2196F3"},children:"To"}),e.jsx(b,{children:t.purch_address})]}),e.jsxs(n,{item:!0,xs:4,children:[e.jsxs(b,{variant:"h6",children:[e.jsx("span",{style:{fontWeight:"bold",color:"#2196F3"},children:"Invoice Date: "})," ",U().format("YYYY-MM-DD")]}),e.jsxs(b,{variant:"h6",style:{marginTop:"8px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"#2196F3"},children:"Due Date: "})," ",U(d).format("YYYY-MM-DD")]})]})]}),e.jsx(O,{style:{marginTop:"20px"},children:e.jsxs(B,{children:[e.jsx(Y,{style:{backgroundColor:"#f0f0f0"},children:e.jsxs(R,{children:[e.jsx(s,{style:{border:"1px solid #ddd",fontWeight:"bold",padding:"8px"},children:"S.No"}),e.jsx(s,{style:{border:"1px solid #ddd",fontWeight:"bold",padding:"8px"},children:"Product Name"}),e.jsx(s,{style:{border:"1px solid #ddd",fontWeight:"bold",padding:"8px"},children:"Description"}),e.jsx(s,{style:{border:"1px solid #ddd",fontWeight:"bold",padding:"8px"},children:"Quantity"}),e.jsx(s,{style:{border:"1px solid #ddd",fontWeight:"bold",padding:"8px"},children:"Price"}),e.jsx(s,{style:{border:"1px solid #ddd",fontWeight:"bold",padding:"8px"},children:"Total"})]})}),e.jsx(Q,{children:e.jsxs(R,{children:[e.jsx(s,{style:{border:"1px solid #ddd",padding:"8px"},children:"01"}),e.jsx(s,{style:{border:"1px solid #ddd",padding:"8px"},children:t.pro_name}),e.jsx(s,{style:{border:"1px solid #ddd",padding:"8px"},children:t.specification}),e.jsx(s,{style:{border:"1px solid #ddd",padding:"8px"},children:t.quantity}),e.jsx(s,{style:{border:"1px solid #ddd",padding:"8px"},children:h.toFixed(2)}),e.jsx(s,{style:{border:"1px solid #ddd",padding:"8px"},children:C.toFixed(2)})]})})]})}),e.jsxs("div",{style:{marginTop:"200px",borderTop:"1px solid #ddd",paddingTop:"10px",textAlign:"right"},children:[e.jsxs(b,{variant:"h6",style:{marginBottom:"8px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"#FF5722"},children:"Price: "})," ",h.toFixed(2)]}),e.jsxs(b,{variant:"h6",style:{marginBottom:"8px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"#FF5722"},children:"GST 18%: "})," ",i.toFixed(2)]}),e.jsxs(b,{variant:"h6",style:{marginBottom:"8px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"#FF5722"},children:"Total: "})," ",C.toFixed(2)]})]}),e.jsx("p",{style:{marginTop:"20px",textAlign:"center"},children:"Thank you for your business."}),e.jsx(p,{ref:o,onClick:a,style:{display:"block",margin:"20px auto",backgroundColor:"#4CAF50",color:"white"},children:"Print Invoice"})]})},Ie=()=>{const[t,d]=x.useState([]),[u,h]=x.useState([]),[i,C]=x.useState(5),[o,a]=x.useState(1),[D,g]=x.useState(!1),[y,c]=x.useState(!1),[l,m]=x.useState(),[v,k]=x.useState(!1),[M,$]=x.useState(),[H,_]=x.useState(!1),[z,V]=x.useState([]),[K,F]=x.useState(!1),[w,L]=x.useState(""),[N,J]=x.useState("");x.useEffect(()=>{I.get(`${A.apiUrl}/purchase/getPurchase`).then(r=>{d(r.data),h(r.data)}).catch(r=>{console.log("Purchase Data could not be fetched.",r)})},[D,y,v]);const X=r=>{const f=parseInt(r.target.value,10);f===1?(C(t.length),a(1)):(C(f),a(1))},Z=(o-1)*i,ee=o*i,te=u.slice(Z,ee),se=r=>{const f=t.find(P=>P.purch_id===r);f&&(m(f),c(!0))},ne=r=>{const f=t.find(P=>P.purch_id===r);f&&(V(f),_(!0))},re=r=>{r&&($(r),k(!0))},ie=()=>{M&&I.delete(`${A.apiUrl}/purchase/delete/${M}`).then(r=>{k(!1)}).catch(r=>{console.log("Purchase Data is not deleted.",r)})},ae=()=>{if(w&&N){const r=t.filter(f=>{const P=G(new Date(f.created_at),"yyyy-MM-dd");return P>=w&&P<=N});h(r)}else h(t)};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-center",children:"Purchase Index"}),e.jsxs(n,{container:!0,spacing:3,className:"mt-3",children:[e.jsx(n,{item:!0,xs:3,display:"flex",justifyContent:"center",children:e.jsx(p,{onClick:()=>g(!0),children:"Add New"})}),e.jsxs(n,{item:!0,xs:3,display:"flex",justifyContent:"center",children:[e.jsx(p,{onClick:()=>F(!0),children:"Upload Excel"})," "]}),e.jsx(n,{item:!0,xs:3,display:"flex",justifyContent:"center",children:e.jsx(ue,{data:t,setData:h})}),e.jsx(n,{item:!0,xs:3,display:"flex",justifyContent:"center",children:e.jsx(ce,{children:e.jsxs(de,{value:i,onChange:X,children:[e.jsx(q,{value:5,children:"5 Per Page"}),e.jsx(q,{value:10,children:"10 Per Page"}),e.jsx(q,{value:15,children:"15 Per Page"}),e.jsx(q,{value:1,children:"All Per Page"})]})})})]}),e.jsx(me,{startDate:w,endDate:N,setStartDate:L,setEndDate:J,onFilter:ae}),e.jsx(O,{component:he,className:"mt-3",children:e.jsxs(B,{children:[e.jsxs(Y,{children:[e.jsx(s,{style:{fontWeight:"bold"},children:"S.No"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Product Name"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Specification"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Address"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Quantity"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Price"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Date"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Total"}),e.jsx(s,{style:{fontWeight:"bold"},children:"GST"}),e.jsx(s,{style:{fontWeight:"bold"},children:"Action"})]}),e.jsx(Q,{children:te.map((r,f)=>e.jsxs(R,{children:[e.jsx(s,{children:f+1}),e.jsx(s,{children:r.pro_name}),e.jsx(s,{children:r.specification}),e.jsx(s,{children:r.purch_address}),e.jsx(s,{children:r.quantity}),e.jsx(s,{children:r.price}),e.jsx(s,{children:(()=>{const P=G(new Date(r.created_at),"dd/MM/yyyy HH:mm:ss"),[le,oe]=P.split(" ");return e.jsxs(e.Fragment,{children:[le," ",e.jsx("span",{style:{color:"red"},children:oe})]})})()}),"                ",e.jsx(s,{children:r.total}),e.jsx(s,{children:r.gst}),e.jsxs(s,{children:[e.jsx(p,{onClick:()=>ne(r.purch_id),children:"Invoice"}),e.jsx(p,{onClick:()=>se(r.purch_id),children:"Edit"}),e.jsx(p,{onClick:()=>re(r.purch_id),children:"Delete"})]})]},f))})]})}),e.jsx(n,{container:!0,spacing:2,children:e.jsx(n,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(xe,{spacing:2,children:e.jsx(fe,{count:Math.ceil(t.length/i),page:o,onChange:(r,f)=>a(f),size:"small"})})})}),e.jsxs(W,{open:D,onClose:()=>g(!1),maxWidth:"md",children:[e.jsx(S,{children:e.jsx(ge,{onClose:()=>g(!1)})}),e.jsx(T,{children:e.jsx(p,{onClick:()=>g(!1),children:"Close"})})]}),e.jsxs(W,{open:y,onClose:()=>c(!1),maxWidth:"md",children:[e.jsx(S,{children:e.jsx(ye,{data:l,onClose:()=>c(!1)})}),e.jsx(T,{children:e.jsx(p,{onClick:()=>c(!1),children:"Close"})})]}),e.jsxs(W,{open:H,onClose:()=>_(!1),maxWidth:"md",children:[e.jsx(S,{children:e.jsx(Ce,{data:z,onClose:()=>_(!1)})}),e.jsxs(T,{className:"mt-5",children:[e.jsx(p,{onClick:()=>window.print(),style:{display:"block"},children:"Print"}),e.jsx(p,{onClick:()=>_(!1),children:"Close"})]})]}),e.jsxs(W,{open:v,onClose:()=>k(!1),children:[e.jsx(S,{children:e.jsx("p",{children:"Are you sure do you want to delete this purchase data ?"})}),e.jsxs(T,{children:[e.jsx(p,{onClick:ie,style:{backgroundColor:"red",color:"whitesmoke"},children:"Delete"}),e.jsx(p,{onClick:()=>k(!1),style:{backgroundColor:"green",color:"whitesmoke"},children:"Cancel"})]})]}),e.jsxs(W,{open:K,onClose:()=>F(!1),maxWidth:"md",children:[" ",e.jsx(S,{children:e.jsx(je,{onClose:()=>F(!1)})}),e.jsx(T,{children:e.jsx(p,{onClick:()=>F(!1),children:"Close"})})]})]})};export{Ie as default};
