import{r as i,j as e,G as u,R as j,g as m,c as W,d as v,F as H,V as J,U as y,z as K,E as Q,H as Z,J as L,K as E,N as n,Q as X,S as Y}from"./index-CxJtQRLb.js";import{S as ee}from"./Search-BCnfRBZA.js";import{A as te}from"./AdminAddCustPurch-DpqvBGV8.js";import{P as se}from"./Pagination-CQtFweVv.js";import{D as P,a as S,b as k}from"./DialogContent-DOuEahYY.js";const re=({data:r,onClose:b})=>{const[o,_]=i.useState({cust_name:r?r.cust_name:"",cust_mobile:r?r.cust_mobile:"",cust_email:r?r.cust_email:"",cust_company:r?r.cust_company:"",cust_address:r?r.cust_address:"",cust_state:r?r.cust_state:"",cust_city:r?r.cust_city:""}),[a,f]=i.useState({cust_name:"",cust_mobile:"",cust_email:"",cust_company:"",cust_address:"",cust_state:"",cust_city:""}),p=(C,c)=>{let s="";const l=c&&typeof c=="string"?c.trim():c;switch(C){case"cust_name":l?/^[a-zA-Z\s]+$/.test(l)||(s="Employee Name must contain only letters and spaces"):s="Customer name is required.";break;case"cust_mobile":l?/^\d{10}$/.test(l)||(s="Phone number must be 10 digits"):s="Customer mobile is required.";break;case"cust_email":l?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)||(s="Invalid email format"):s="Customer Email is required.";break;case"cust_company":l||(s="Customer Company is required.");break;case"cust_address":l||(s="Customer Address is required.");break;case"cust_state":l||(s="Customer State is required.");break;case"cust_city":l||(s="Customer City is required.");break}return s},d=C=>{const{name:c,value:s}=C.target,l=p(c,s);_({...o,[c]:s}),f({...a,[c]:l})},D=C=>{C.preventDefault();let c={};if(Object.keys(o).forEach(s=>{const l=o[s],x=p(s,l);x&&(c=x)}),Object.keys(c).length>0){f(c);return}W.put(`${v.apiUrl}/customer/update/${r.cust_id}`,o).then(s=>{b()}).catch(s=>{console.log("Error:",s)})};return e.jsx(e.Fragment,{children:e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,label:"Customer Name",name:"cust_name",onChange:d,value:o.cust_name,error:!!a.cust_name,helperText:a.cust_name})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,label:"Customer Mobile",name:"cust_mobile",onChange:d,value:o.cust_mobile,error:!!a.cust_mobile,helperText:a.cust_mobile})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,label:"Customer Email",name:"cust_email",onChange:d,value:o.cust_email,error:!!a.cust_email,helperText:a.cust_email})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,label:"Customer Company",name:"cust_company",onChange:d,value:o.cust_company,error:!!a.cust_company,helperText:a.cust_company})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,label:"Customer Address",name:"cust_address",onChange:d,value:o.cust_address,error:!!a.cust_address,helperText:a.cust_address})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,label:"Customer State",name:"cust_state",onChange:d,value:o.cust_state,error:!!a.cust_state,helperText:a.cust_state})}),e.jsx(u,{item:!0,xs:6,children:e.jsx(j,{fullWidth:!0,label:"Customer City",name:"cust_city",onChange:d,value:o.cust_city,error:!!a.cust_city,helperText:a.cust_city})}),e.jsx(u,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(m,{onClick:D,variant:"contained",color:"primary",children:"Submit"})})]})})},oe=()=>{const[r,b]=i.useState([]),[o,_]=i.useState([]),[a,f]=i.useState(5),[p,d]=i.useState(1),[D,C]=i.useState(!1),[c,s]=i.useState(!1),[l,x]=i.useState(!1),[A,T]=i.useState([]),[U,N]=i.useState(),[I,g]=i.useState(!1),[w,O]=i.useState();i.useEffect(()=>{W.get(`${v.apiUrl}/customer/getCustomerForAdmin`).then(t=>{b(t.data),_(t.data)}).catch(t=>{console.log("Customer Data is not fetched.")})},[D,c,l]);const $=t=>{const h=r.find(G=>G.cust_id===t);h&&(T(h),s(!0))},q=t=>{N(t),x(!0)},F=()=>{W.delete(`${v.apiUrl}/customer/delete/${U}`).then(t=>{x(!1)}).catch(t=>{console.log("Error deleting data. Please try again later.")})},M=t=>{const h=parseInt(t.target.value,10);h==1?(f(r.length),d(1)):(f(h),d(1))},z=(p-1)*a,R=p*a,V=o.slice(z,R),B=t=>{O(t),g(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center",children:"Customer Index"}),e.jsxs(u,{container:!0,spacing:2,className:"mt-3",children:[e.jsx(u,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(ee,{data:r,setData:_})}),e.jsx(u,{item:!0,xs:4,display:"flex",justifyContent:"center",children:e.jsx(H,{children:e.jsxs(J,{value:a,onChange:M,children:[e.jsx(y,{value:5,children:"5 Per Page"}),e.jsx(y,{value:10,children:"10 Per Page"}),e.jsx(y,{value:15,children:"15 Per Page"}),e.jsx(y,{value:1,children:"All Per Page"})]})})})]}),e.jsx(K,{component:Q,className:"mt-3",children:e.jsxs(Z,{style:{borderCollapse:"collapse"},children:[e.jsx(L,{children:e.jsxs(E,{children:[e.jsx(n,{style:{fontWeight:"bold"},children:"S.no"}),e.jsx(n,{style:{fontWeight:"bold"},children:"Employee Name"}),e.jsx(n,{style:{fontWeight:"bold"},children:"Customer Name"}),e.jsx(n,{style:{fontWeight:"bold"},children:"Mobile"}),e.jsx(n,{style:{fontWeight:"bold"},children:"Email"}),e.jsx(n,{style:{fontWeight:"bold"},children:"Company"}),e.jsx(n,{style:{fontWeight:"bold"},children:"Address"}),e.jsx(n,{style:{fontWeight:"bold"},children:"State"}),e.jsx(n,{style:{fontWeight:"bold"},children:"City"}),e.jsx(n,{style:{fontWeight:"bold"},children:"Action"})]})}),e.jsx(X,{children:V.map((t,h)=>e.jsxs(E,{children:[e.jsx(n,{children:h+1}),e.jsx(n,{children:t.emp_name}),e.jsx(n,{children:t.cust_name}),e.jsx(n,{children:t.cust_mobile}),e.jsx(n,{children:t.cust_email}),e.jsx(n,{children:t.cust_company}),e.jsx(n,{children:t.cust_address}),e.jsx(n,{children:t.cust_state}),e.jsx(n,{children:t.cust_city}),e.jsxs(n,{children:[e.jsx(m,{onClick:()=>B(t.cust_id),children:"Purchase"}),e.jsx(m,{onClick:()=>$(t.cust_id),children:"Edit"}),e.jsx(m,{onClick:()=>q(t.cust_id),children:"Delete"})]})]},t.cust_id))})]})}),e.jsx(u,{container:!0,spacing:2,display:"flex",justifyContent:"center",className:"mt-4",children:e.jsx(Y,{spacing:2,children:e.jsx(se,{count:Math.ceil(r.length/a),page:p,onChange:(t,h)=>d(h),size:"small",style:{cursor:"pointer","&:hover":{backgroundColor:"transparent"}}})})}),e.jsxs(P,{open:c,onClose:()=>s(!1),maxWidth:"lg",children:[e.jsx(S,{children:e.jsx(re,{data:A,onClose:()=>s(!1)})}),e.jsx(k,{children:e.jsx(m,{onClick:()=>s(!1),children:"Close"})})]}),e.jsxs(P,{open:l,onClose:()=>x(!1),children:[e.jsx(S,{children:e.jsx("p",{children:"Are you sure you want to delete this Customer data?"})}),e.jsxs(k,{children:[e.jsx(m,{onClick:F,style:{backgroundColor:"red",color:"white"},children:"Delete"}),e.jsx(m,{onClick:()=>x(!1),style:{backgroundColor:"green",color:"white"},children:"Cancel"})]})]}),e.jsxs(P,{open:I,onClose:()=>g(!1),maxWidth:"lg",children:[e.jsx(S,{children:e.jsx(te,{cust_id:w,onClose:()=>g(!1)})}),e.jsx(k,{children:e.jsx(m,{onClick:()=>g(!1),children:"Close"})})]})]})};export{oe as default};
