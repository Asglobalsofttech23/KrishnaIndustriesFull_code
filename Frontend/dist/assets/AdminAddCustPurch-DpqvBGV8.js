import{r as c,X as q,c as y,d as _,j as e,G as o,R as i,U as d,g as D}from"./index-CxJtQRLb.js";const E=({cust_id:h,onClose:g})=>{const[C,v]=c.useState([]),[j,F]=c.useState([]),P=q(),[n,S]=c.useState({cust_id:h||"",pro_id:"",quantity:"",price:"",payment_type:"",payment_amount:"",balance:"",total:""}),[a,f]=c.useState({cust_id:h,pro_id:"",quantity:"",price:"",payment_type:"",payment_amount:"",balance:"",total:""});c.useEffect(()=>{y.get(`${_.apiUrl}/product/getProductData`).then(t=>{v(t.data)}).catch(t=>{console.log("Customer purchase data is not fetched.")})},[]),c.useEffect(()=>{y.get(`${_.apiUrl}/customer/getCustomerForAdmin`).then(t=>{F(t.data)}).catch(t=>{console.log("Customer data is not fetched.")})},[]);const b=(t,r)=>{r&&typeof r=="string"&&r.trim()},u=t=>{const{name:r,value:s}=t.target;let l={...n,[r]:s};if(r==="payment_type"&&s==="partial"){const p=parseFloat(l.total||0),m=parseFloat(l.payment_amount||0);l.balance=(p-m).toFixed(2)}else if(r==="payment_amount"){const p=parseFloat(l.total||0),m=parseFloat(s||0);l.balance=(p-m).toFixed(2)}else if(r==="quantity"||r==="price"){const p=parseFloat(l.quantity||0),m=parseFloat(l.price||0);l.total=(p*m).toFixed(2)}const x=b(r,s);S(l),f({...a,[r]:x})},T=t=>{t.preventDefault();let r={};if(Object.keys(n).forEach(s=>{const l=n[s],x=b(s,l);x&&(r=x)}),Object.keys(r).length>0){f(r);return}y.post(`${_.apiUrl}/cust_purch/addCustPurch`,n).then(s=>{g(),P("/CustPurchIndex")}).catch(s=>{console.log("Error:",s)})};return e.jsx("div",{children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:6,children:h?e.jsx(i,{select:!0,fullWidth:!0,name:"cust_id",label:"Select customer",onChange:u,value:n.cust_id,disabled:!0,children:j.map(t=>e.jsx(d,{value:t.cust_id,children:t.cust_name},t.cust_id))}):e.jsx(i,{select:!0,fullWidth:!0,name:"cust_id",label:"Select customer",onChange:u,value:n.cust_id,error:!!a.cust_id,helperText:a.cust_id,children:j.map(t=>e.jsx(d,{value:t.cust_id,children:t.cust_name},t.cust_id))})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(i,{select:!0,fullWidth:!0,name:"pro_id",label:"Select Product Name",onChange:u,value:n.pro_id,error:!!a.pro_id,helperText:a.pro_id,children:C.map(t=>e.jsx(d,{value:t.pro_id,children:t.pro_name},t.pro_id))})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"quantity",label:"Quantity",type:"number",onChange:u,value:n.quantity,error:!!a.quantity,helperText:a.quantity})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"price",label:"Price",type:"number",onChange:u,value:n.price,error:!!a.price,helperText:a.price})}),e.jsx(o,{item:!0,xs:6,children:e.jsxs(i,{select:!0,fullWidth:!0,name:"payment_type",label:"Select Payment type",onChange:u,value:n.payment_type,error:!!a.payment_type,helperText:a.payment_type,children:[e.jsx(d,{value:"full",children:"Full Payment"}),e.jsx(d,{value:"partial",children:"Partial Payment"})]})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"total",label:"Total",type:"number",onChange:u,value:n.total,error:!!a.total,helperText:a.total})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"payment_amount",label:"Amount",type:"number",onChange:u,value:n.payment_amount,error:!!a.payment_amount,helperText:a.payment_amount})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(i,{fullWidth:!0,name:"balance",label:"Balance Amount",type:"number",onChange:u,value:n.balance,error:!!a.balance,helperText:a.balance})}),e.jsx(o,{item:!0,xs:12,display:"flex",justifyContent:"center",children:e.jsx(D,{onClick:T,children:"Submit"})})]})})};export{E as A};
